You have two datasets:

transactions_df
transaction_id (string)
customer_id (string)
product_id (string)
amount (decimal)
transaction_date (timestamp)

products_df
product_id (string)
category (string)

Task

For each customer, compute their top 2 categories by total spend in the last 60 days.
For each customer-category combination, compute:
total_amount spent
total_transactions count

The final DataFrame should have:

customer_id
category
total_amount
total_transactions
rank_in_customer (rank the categories per customer by total_amount)