Organizational Hierarchy & Rollups

Youâ€™re given a table employees:

employees
----------
emp_id        INT
emp_name      STRING
manager_id    INT   -- NULL if top-level
salary        INT


Each employee has 0 or 1 manager. The hierarchy can go multiple levels deep.

Task:

For each employee, return their full chain of managers (top â†’ bottom).
Compute the total salary under each manager, i.e. the sum of salaries of all direct and indirect reports.

Example Input:

emp_id	emp_name	manager_id	salary
1	Alice	NULL	300
2	Bob	1	200
3	Carol	1	250
4	Dave	2	150
5	Eve	2	100

Expected Output:

ðŸ”¹ Part 1 (chains):

emp_id	emp_name	manager_chain
1	Alice	Alice
2	Bob	Alice â†’ Bob
3	Carol	Alice â†’ Carol
4	Dave	Alice â†’ Bob â†’ Dave
5	Eve	Alice â†’ Bob â†’ Eve

ðŸ”¹ Part 2 (salary rollup):

manager_id	manager_name	total_team_salary
1	Alice	1000
2	Bob	250